---
execute: 
  echo: true
  cache: true
---

# Prediction {#sec-prediction}

```{r}
#| label: setup-options
#| child: "_common.qmd"
```

... Quote ...

::: callout-note
## Keys

- ...
:::

```{r}
#| label: prediction-data-packages
#| echo: false
#| message: false
# Packages

pacman::p_load(tidyverse, patchwork, knitr, broom, effectsize, report, janitor, skimr, languageR)
```

In this chapter I present an introduction to approaches to data analysis known as machine learning, specifically supervised learning. In a nutshell, the aim of supervised learning is to leverage a potential relationship between a target or outcome variable and a set of other variables (features) derived from text to create a statistical generalization (model) that can accurately predict the values of the target variable using the values of the feature variables. We consider practical tasks as well as theoretical applications of the statistical learning in text analysis highlighting the standard workflow for building predictive models, testing and evaluating models, working to improve model performance, and how to interpret and report findings.

::: callout-tip
## Swirl

**What**: [Supervised Learning](https://github.com/lin380/swirl)\
**How**: In the R Console pane load `swirl`, run `swirl()`, and follow prompts to select the lesson.\
**Why**: ...
:::


- Overview:
    - Research goals (predict, prescribe, verify)
    - Use of data
        - Partitioned: training (reusable) and test (reserved) sets
        - Outcome variable and predictor/ covariate variables
        - Fixed outcome and mutable predictor variables/ features
    - Methods
        - Supervised machine learning methods
            - Regression
            - Classification
    - Data types/ structures
        - Matrices
    - Interpreting results (quantitative)
        - Summary statistics: 
            - Accuracy
            - Precision
            - Recall
            - F1
            - Confusion matrix
- Supervised machine learning analysis
    - Methods: 
        - Regression (continuous outcome variable)
            - Linear regression
            - Decision trees
            - Neural networks
        - Classification (categorical outcome variable)
            - Logistic regression
            - Decision trees
            - Neural networks



<!---

Supervised machine learning is a type of artificial intelligence that involves training a model on a labeled dataset where the input data and desired output are both provided. The model is able to make predictions or classifications based on the input data by learning the relationships between the input and output data. Supervised machine learning is an important tool for linguists studying language and communication, as it allows them to analyze language data and identify patterns or trends in language use. There are two main types of supervised machine learning algorithms: classification, which is used to predict a categorical outcome such as the genre of a text, and regression, which is used to predict a continuous outcome such as the sentiment of a text. In order to use supervised machine learning, linguists must first prepare the data by cleaning and preprocessing it, and then split the data into training and testing sets. The model is then trained on the training data and evaluated on the testing data, and the hyperparameters of the model may be adjusted to optimize its performance. Some applications of supervised machine learning in linguistics include text classification, part-of-speech tagging, and language identification. Supervised machine learning is an active area of research in linguistics, with many potential applications and areas for further exploration.


I. Introduction to supervised machine learning
A. Definition of supervised machine learning
i. Supervised machine learning involves training a model on a labeled dataset where the input data and desired output are both provided
ii. The model is able to make predictions or classifications based on the input data by learning the relationships between the input and output data
B. Importance of supervised machine learning for linguistics
i. Supervised machine learning can be used to analyze language data and identify patterns or trends in language use
ii. Supervised machine learning can help linguists classify texts, predict language evolution, and identify language-specific features

II. Types of supervised machine learning algorithms
A. Classification
i. Classification algorithms are used to predict a categorical outcome, such as whether a text belongs to a particular genre
ii. Examples of classification algorithms include decision trees, logistic regression, and support vector machines
B. Regression
i. Regression algorithms are used to predict a continuous outcome, such as the sentiment of a text
ii. Examples of regression algorithms include linear regression and multiple linear regression

III. Preparing data for supervised machine learning
A. Data preprocessing
i. Data preprocessing involves cleaning and preparing the data for analysis
ii. This may include tasks such as removing missing values, scaling the data, and encoding categorical variables
B. Data splitting
i. Data splitting involves dividing the data into training and testing sets
ii. The training set is used to train the model, while the testing set is used to evaluate the model's performance

IV. Training and evaluating a supervised machine learning model
A. Training a model
i. Training a model involves providing the model with the training data and adjusting the model's parameters to minimize the error between the model's predictions and the true output
B. Evaluating a model
i. Evaluating a model involves using the testing data to measure the model's performance
ii. Common evaluation metrics for supervised machine learning include accuracy, precision, and recall
C. Tuning model hyperparameters
i. Hyperparameters are the parameters of the machine learning model that are set before training begins
ii. Tuning hyperparameters involves adjusting the values of the hyperparameters to optimize the model's performance

V. Applications of supervised machine learning in linguistics
A. Text classification
i. Text classification involves categorizing texts into predefined categories, such as genre or topic
ii. Supervised machine learning can be used to classify texts based on their content or linguistic features
B. Part-of-speech tagging
i. Part-of-speech tagging involves assigning a part of speech to each word in a text
ii. Supervised machine learning can be used to identify the part of speech of a word based on its context and other linguistic features
C. Language identification
i. Language identification involves determining the language of a text
ii. Supervised machine learning can be used to identify the language of a text based on its content or linguistic features

VI. Conclusion
A. Recap of key points
i. Supervised machine learning is a type of machine learning that involves training a model on a labeled dataset
ii. Supervised machine learning can be used to classify texts, predict language evolution, and identify language-specific features
B. Future directions for supervised machine learning in linguistics
i. Supervised machine learning is an active area of research in linguistics, with many potential applications and areas for further exploration
ii. Future research may focus on developing more sophisticated



# Research

Strengths:
1. Neural networks are able to capture complex relationships between words and phrases in text.
2. Neural networks can learn from large amounts of data and can be trained to classify text with high accuracy.
3. Neural networks can be used to classify text into multiple categories.
4. Neural networks can be used to identify patterns in text that are not easily detected by traditional methods.

Weaknesses:
1. Neural networks require a large amount of data to train and can be computationally expensive.
2. Neural networks can be prone to overfitting if the data is not properly preprocessed.
3. Neural networks can be difficult to interpret and explain due to their complexity.
4. Neural networks can be sensitive to noise and outliers in the data.


-->


## Activities {.unnumbered}

::: callout-tip
## Recipe

**What**: [Predictive models: prep, train, test, and evaluate](https://lin380.github.io/tadr/articles/recipe_10.html)\
**How**: Read Recipe 10 and participate in the Hypothes.is online social annotation.\
**Why**: To illustrate some common coding strategies for preparing datasets for inferential data analysis, as well as the steps conduct descriptive assessment, statistical interrogation, and evaluation and reporting of results.
:::

::: callout-tip
## Lab

**What**: [Predictive Data Analysis](https://github.com/lin380/lab_10)\
**How**: Clone, fork, and complete the steps in Lab 10.\
**Why**: To gain experience working with coding strategies to prepare, feature engineer, train and test a predictive model, and evaluate results from a predictive data analysis, practice transforming datasets into new object formats and visualizing relationships, and implement organizational strategies for organizing and reporting results in a reproducible fashion.
:::

## Questions {.unnumbered}

::: callout-note
## Conceptual questions

1. What is the difference between a continuous and a categorical variable?
2. What is the difference between a regression and a classification model?
3. What is the difference between a training set and a testing set?
4. What is the difference between a hyperparameter and a parameter?
5. What is the difference between a supervised and an unsupervised machine learning model?
6. What advantages and disadvantages do supervised machine learning models have over traditional methods of text analysis?
7. What are some potential applications of supervised machine learning in linguistics?

:::

::: callout-note
## Technical exercises

1. Write a program to build a classification model which uses a set of collected text features to predict a target variable.
2. Use the classification model to classify a series of documents and assess the accuracy of the model.
3. Develop a regression model which uses text features to predict a continuous target variable.
4. Create a text mining application to analyze a large body of text and discover correlations between variables.
5. Use a clustering algorithm to discover clusters in a large dataset, and create a visualization to present the identified clusters.
6. Analyze the structure of a text corpus and identify patterns in word usage and feature distributions.
7. Build a predictive model using text as an input and binary or categorical outcomes as the target.
8. Develop a natural language processing application which classifies text into predefined categories using a supervised learning algorithm.
9. Use a supervised learning algorithm to build a predictive model which classifies a set of unseen texts into predefined categories.
10. Develop a web application which allows users to easily explore a set of text documents, visualize the content of the documents, and generate predictive models from the text.

:::

